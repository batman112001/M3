<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Download</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body class="center">
  <a id="downloadBtn" class="download-button" style="display:none" target="_blank">Download</a>
  <p id="status">Loadingâ€¦</p>

  <script>
    (async () => {
      const params = new URLSearchParams(location.search);
      const id = params.get("id");

      const status = document.getElementById("status");
      const btn = document.getElementById("downloadBtn");

      if (!id) {
        status.textContent = "No file id provided.";
        return;
      }

      try {
        const res = await fetch(`/api/file?id=${encodeURIComponent(id)}`);
        const data = await res.json();

        if (!res.ok) {
          status.textContent = data.error || "File not found.";
          return;
        }

        btn.href = data.url;
        btn.style.display = "inline-block";
        status.remove();
      } catch (e) {
        status.textContent = "Error loading file.";
        console.error(e);
      }
    })();
  </script>
</body>
</html>
